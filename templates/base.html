{% load static %}
<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>{% block title %}–ú—É–∑—ã–∫–∞–ª—å–Ω–∞—è —à–∫–æ–ª–∞ ‚Äî –∂—É—Ä–Ω–∞–ª{% endblock %}</title>
  <link rel="stylesheet" href="{% static 'css/main.css' %}">
</head>
<body>
  <header class="site-header">
    <div class="container header-row">
      <div class="brand">
        <a href="/dashboard">–ñ—É—Ä–Ω–∞–ª (–¥–µ–º–æ)</a>
      </div>
      <nav class="nav">
        {% if user.is_authenticated %}
          <a href="/courses/">–ö—É—Ä—Å—ã</a>
          <a href="/logout">–í—ã–π—Ç–∏</a>
        {% else %}
          <a href="/login">–í—Ö–æ–¥</a>
        {% endif %}
      </nav>
      <button class="theme-toggle" type="button" id="theme-toggle" aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">
        <span aria-hidden="true">üåô</span>
      </button>
    </div>
  </header>

  <main class="container">
    {% if messages %}
      <div class="messages">
        {% for message in messages %}
          <div class="message {{ message.tags }}">{{ message }}</div>
        {% endfor %}
      </div>
    {% endif %}

    {% block content %}{% endblock %}
  </main>

  <footer class="site-footer">
    <div class="container">
      <small>–î–µ–º–æ-–ø—Ä–æ–µ–∫—Ç: –º—É–∑—ã–∫–∞–ª—å–Ω–∞—è —à–∫–æ–ª–∞ ¬∑ Django ¬∑ SQLite</small>
    </div>
  </footer>

  {% if user.is_authenticated %}
    <nav class="bottom-nav">
      <a class="bottom-link {% if request.path|slice:':10' == '/calendar/' %}active{% endif %}"
       href="/calendar/">–ö–∞–ª–µ–Ω–¥–∞—Ä—å</a>

      <a class="bottom-link {% if request.path|slice:':9' == '/lessons/' %}active{% endif %}"
       href="/lessons/">–£—Ä–æ–∫–∏</a>

      <a class="bottom-link {% if request.path|slice:':12' == '/attendance/' %}active{% endif %}"
       href="/attendance/">–ü–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å</a>

      <a class="bottom-link {% if request.path|slice:':7' == '/goals/' %}active{% endif %}"
       href="/goals/">–ì–æ–¥–æ–≤–æ–π –ø–ª–∞–Ω</a>

      {% if user.profile.role == "STUDENT" or user.profile.role == "PARENT" %}
        <a class="bottom-link {% if '/students/' in request.path or '/portfolio/' in request.path %}active{% endif %}"
         href="/portfolio/">–ü—Ä–æ—Ñ–∏–ª—å</a>
      {% endif %}
  </nav>
{% endif %}

  <script>
    const themeToggle = document.getElementById("theme-toggle");
    const storedTheme = localStorage.getItem("theme");
    if (storedTheme === "light") {
      document.body.dataset.theme = "light";
      if (themeToggle) {
        themeToggle.querySelector("span").textContent = "‚òÄÔ∏è";
      }
    }
    if (themeToggle) {
      themeToggle.addEventListener("click", () => {
        const isLight = document.body.dataset.theme === "light";
        if (isLight) {
          delete document.body.dataset.theme;
          localStorage.setItem("theme", "dark");
          themeToggle.querySelector("span").textContent = "üåô";
        } else {
          document.body.dataset.theme = "light";
          localStorage.setItem("theme", "light");
          themeToggle.querySelector("span").textContent = "‚òÄÔ∏è";
        }
      });
    }
  </script>
</body>
</html>
