{% extends "base.html" %}
{% block title %}Цели на полугодие{% endblock %}
{% block content %}
  <h1>Цели на полугодие</h1>
  <p class="muted">Ученик: {{ selected_student.get_full_name|default:"Без имени" }}</p>

  <div class="card" style="margin-bottom: 16px;">
    <form method="post" id="goal-create-form">
      {% csrf_token %}
      <div id="goal-input-list">
        {% for value in entered_titles %}
          <div class="form-row" data-goal-row>
            <label>Цель</label>
            <input class="input" type="text" name="goal_titles" value="{{ value }}" placeholder="Цель на полугодие"/>
          </div>
        {% endfor %}
      </div>

      <button class="btn" type="button" id="goal-add-row">+</button>

      {% if title_errors %}
        {% for error in title_errors %}
          <div class="error">{{ error }}</div>
        {% endfor %}
      {% endif %}

      <button class="btn" type="submit">Сохранить</button>
      <a class="btn" href="/goals/?student={{ selected_student.id }}">Отмена</a>
    </form>
  </div>

  <script>
    (function () {
      const addButton = document.getElementById("goal-add-row");
      const list = document.getElementById("goal-input-list");
      if (!addButton || !list) return;
      addButton.addEventListener("click", function () {
        const row = document.createElement("div");
        row.className = "form-row";
        row.setAttribute("data-goal-row", "1");
        row.innerHTML = '<label>Цель</label><input class="input" type="text" name="goal_titles" placeholder="Цель на полугодие"/>';
        list.appendChild(row);
      });
    })();
  </script>
{% endblock %}
